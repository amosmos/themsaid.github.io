<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Web developer [PHP, Laravel, Vue.js] &amp; iOS beginner.">

    <title>themsaid </title>

    <link href="http:/themsaid.github.io/feed.rss" rel="alternate" type="application/rss+xml" title="Mohamed Said - themsaid"/>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.min.css' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/libs.css">
    <link rel="stylesheet" href="/prism.css">
    <link rel="stylesheet" href="/style.css">
</head>

<body>

<div class="container">
    <div class="row main-row">
        <div class="col-md-8 main-content">
            
    <a href="/">Back to home</a>

    <h1 class="blog-post-title">A look at Laravel 5.3 Notification System</h1>

                <p>While Laravel is already shipped with many built-in solutions for many application development problems, it still presents new ones with every new release, Laravel 5.3 is no exception.</p>
<p>One of the neat features of Laravel 5.3 is the all-new notification system. Being a built-in feature, notifications will never be a hard task to build again. Let's see how easy it is to build and send a notification:</p>
<pre><code class="language-php">class NewPost extends \Illuminate\Notifications\Notification
{
    public function __construct($post)
    {
        $this-&gt;post = $post;
    }

    public function via($notifiable)
    {
        return ['database'];
    }

    public function toArray($notifiable)
    {
        return [
            'message' =&gt; 'A new post was published on Laravel News.',
            'action' =&gt; url($this-&gt;post-&gt;slug)
        ];
    }
}</code></pre>
<p>All you need to do now is to send the notification to the selected users:</p>
<pre><code class="language-php">$user-&gt;notify(new NewPost($post));</code></pre>
<h2>Creating Notifications</h2>
<p>Laravel 5.3 is shipped with a new console command for creating notifications:</p>
<pre><code class="language-bash">php artisan make:notification NewPost</code></pre>
<p>This will create a new class in <code>app/Notifications</code>, each notification class contains a <code>via()</code> method as well as different methods for building notifications for different channels.</p>
<p>Using the <code>via()</code> method you can specifying the channels you'd like this particular notification to be sent through, check this example for the official documentation website:</p>
<pre><code class="language-php">public function via($notifiable)
{
    return $notifiable-&gt;prefers_sms ? ['sms'] : ['mail', 'database'];
}</code></pre>
<p>The via method receives a <code>$notifiable</code> instance, which is the model you're sending the notification to, in most cases it'll be the user model but it's not limited to that.</p>
<p>Available channels are: <code>mail</code>, <code>nexmo</code>, <code>database</code>, <code>broadcast</code>, and <code>slack</code>.</p>
<h3>Formatting Email Notifications</h3>
<p>You can format how notifications are sent through different channels, for instance let's take a look at formatting a mail notification:</p>
<pre><code class="language-php">public function toMail($notifiable)
{
    return (new MailMessage)
                   -&gt;subject('New Post!')
                -&gt;line('A new post was published on Laravel News!')
                -&gt;action('Read Post', url($this-&gt;post-&gt;slug))
                -&gt;line('Please don\'t forget to share.');
}</code></pre>
<p>This will create a mail message using a nice built-in responsive template that you can publish using the <code>vendor:publish</code> console command.</p>
<p>The notification system will automatically look for an <code>email</code> property in your model, however you can customise this behaviour by defining a <code>routeNotificationForMail</code> in your Model and return the email address this Model will be contacted on.</p>
<h3>Formatting Nexmo SMS Notifications</h3>
<p>Same as in the case of an email notification, you need to define a <code>toNexmo</code> method in your notification class:</p>
<pre><code class="language-php">public function toNexmo($notifiable)
{
    return (new NexmoMessage)
        -&gt;from(123456789)
        -&gt;content('New post on Laravel News!');
}</code></pre>
<p>In the case of Nexmo notifications, laravel will look for a <code>phone_number</code> property in the model. You can override that by defining a <code>routeNotificationForNexmo</code> method.</p>
<p>You can set a global <code>from</code> number in your nexmo configuration file, that way you won't have to provide a <code>from</code> number in each notification.</p>
<h3>Formatting Database Notifications</h3>
<p>To Format a database notification you may define a <code>toDatabase</code> method:</p>
<pre><code class="language-php">public function toDatabase($notifiable)
{
    return new DatabaseMessage([
        'message' =&gt; 'A new post was published on Laravel News.',
        'action' =&gt; url($this-&gt;post-&gt;slug)
    ]);
}</code></pre>
<p>To start using the database channel you may read the full documentation on the <a href="https://laravel.com/docs/master/notifications#database-notifications">official website</a>.</p>
<h2>Sending Notifications</h2>
<p>You can send notifications using the <code>notify()</code> method on your mode, this method exists on the <code>Notifiable</code> trait which you'll need to add to your Model.</p>
<pre><code class="language-php">$user-&gt;notify(new NewPost($post));</code></pre>
<p>You can also use the Notification facade, this will allow you to send notifications to multiple notifiables at the same time:</p>
<pre><code class="language-php">Notification::send(User::all(), new NewPost($post));</code></pre>
<h2>Queueing Notifications</h2>
<p>You can easily queue sending notifications by using the <code>ShouldQueue</code> interface on the Notification class and including the <code>Queueable</code> trait.</p>
<pre><code class="language-php">&lt;?php

namespace App\Notifications;

use Illuminate\Bus\Queueable;
use Illuminate\Notifications\Notification;
use Illuminate\Contracts\Queue\ShouldQueue;

class NewPost extends Notification implements ShouldQueue
{
    use Queueable;
}</code></pre>
            
    <span class="post-footer">—————————————&nbsp&nbspThat's all folks&nbsp&nbsp—————————————</span>

    <div class="text-center">
        <a href="https://twitter.com/share"
           class="twitter-share-button"
           data-text="A look at Laravel 5.3 Notification System"
           data-via="themsaid">Tweet</a>
        &nbsp&nbsp&nbsp
        <a href="https://twitter.com/intent/tweet?screen_name=themsaid"
           class="twitter-mention-button"
           data-related="themsaid">Tweet to @themsaid</a>
    </div>
        </div>

        <div class="col-md-3 col-md-offset-1 sidebar">
            <div class="avatar">
                <a href="/"><img src="http://s7.postimg.org/weovsp0qz/themsaid.jpg"></a>
            </div>

            <h1>themsaid</h1>

            <p>Mohamed Said is a web developer [PHP, Laravel, Vue.js] & iOS beginner.</p>

            <a href="https://github.com/themsaid">@github</a> ·
            <a href="https://twitter.com/themsaid">@twitter</a> ·
            <a href="mailto:themsaid@gmail.com">@email</a>
        </div>
    </div>

    <p class="footer">
        © Mohamed Said 2016 · Built with <a href="http://themsaid.github.io/katana/">Katana</a>
    </p>
</div>

<script src="/prism.js"></script>

<script>!function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
        if (!d.getElementById(id)) {
            js = d.createElement(s);
            js.id = id;
            js.src = p + '://platform.twitter.com/widgets.js';
            fjs.parentNode.insertBefore(js, fjs);
        }
    }(document, 'script', 'twitter-wjs');</script>
<script>(function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o), m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-61501903-1', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>